{"version":3,"sources":["file:///D:/program/cocos/project/FlappyBird/assets/scripts/AudioMgr.ts"],"names":["AudioMgr","Node","AudioSource","AudioClip","resources","director","inst","_inst","constructor","_audioSource","audioMgr","name","getScene","addChild","addPersistRootNode","addComponent","audioSource","playOneShot","sound","volume","load","err","clip","console","log","play","stop","loop","pause","resume"],"mappings":"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","sourcesContent":["//AudioMgr.ts\r\nimport { Node, AudioSource, AudioClip, resources, director } from \"cc\";\r\n/**\r\n * @en\r\n * this is a sington class for audio play, can be easily called from anywhere in you project.\r\n * @zh\r\n * 这是一个用于播放音频的单件类，可以很方便地在项目的任何地方调用。\r\n */\r\nexport class AudioMgr {\r\n  private static _inst: AudioMgr;\r\n  public static get inst(): AudioMgr {\r\n    if (this._inst == null) {\r\n      this._inst = new AudioMgr();\r\n    }\r\n    return this._inst;\r\n  }\r\n\r\n  private _audioSource: AudioSource;\r\n  constructor() {\r\n    //@en create a node as audioMgr\r\n    //@zh 创建一个节点作为 audioMgr\r\n    let audioMgr = new Node();\r\n    audioMgr.name = \"__audioMgr__\";\r\n\r\n    //@en add to the scene.\r\n    //@zh 添加节点到场景\r\n    director.getScene().addChild(audioMgr);\r\n\r\n    //@en make it as a persistent node, so it won't be destroied when scene change.\r\n    //@zh 标记为常驻节点，这样场景切换的时候就不会被销毁了\r\n    director.addPersistRootNode(audioMgr);\r\n\r\n    //@en add AudioSource componrnt to play audios.\r\n    //@zh 添加 AudioSource 组件，用于播放音频。\r\n    this._audioSource = audioMgr.addComponent(AudioSource);\r\n  }\r\n\r\n  public get audioSource() {\r\n    return this._audioSource;\r\n  }\r\n\r\n  /**\r\n   * @en\r\n   * play short audio, such as strikes,explosions\r\n   * @zh\r\n   * 播放短音频,比如 打击音效，爆炸音效等\r\n   * @param sound clip or url for the audio\r\n   * @param volume\r\n   */\r\n  playOneShot(sound: AudioClip | string, volume: number = 1.0) {\r\n    if (sound instanceof AudioClip) {\r\n      this._audioSource.playOneShot(sound, volume);\r\n    } else {\r\n      resources.load(sound, (err, clip: AudioClip) => {\r\n        if (err) {\r\n          console.log(err);\r\n        } else {\r\n          this._audioSource.playOneShot(clip, volume);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @en\r\n   * play long audio, such as the bg music\r\n   * @zh\r\n   * 播放长音频，比如 背景音乐\r\n   * @param sound clip or url for the sound\r\n   * @param volume\r\n   */\r\n  play(sound: AudioClip | string, volume: number = 1.0) {\r\n    if (sound instanceof AudioClip) {\r\n      this._audioSource.stop();\r\n      this._audioSource.clip = sound;\r\n      //设置循环播放\r\n      this._audioSource.loop=true;\r\n      this._audioSource.play();\r\n      this.audioSource.volume = volume;\r\n    } else {\r\n      resources.load(sound, (err, clip: AudioClip) => {\r\n        if (err) {\r\n          console.log(err);\r\n        } else {\r\n          this._audioSource.stop();\r\n          this._audioSource.clip = clip;\r\n          this._audioSource.loop = true;\r\n          this._audioSource.play();\r\n          this.audioSource.volume = volume;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * stop the audio play\r\n   */\r\n  stop() {\r\n    this._audioSource.stop();\r\n  }\r\n\r\n  /**\r\n   * pause the audio play\r\n   */\r\n  pause() {\r\n    this._audioSource.pause();\r\n  }\r\n\r\n  /**\r\n   * resume the audio play\r\n   */\r\n  resume() {\r\n    this._audioSource.play();\r\n  }\r\n}\r\n"]}